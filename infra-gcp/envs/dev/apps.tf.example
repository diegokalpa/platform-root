# Ejemplo: Agregar aplicaciones usando el m√≥dulo de Cloud Run
# Copia este archivo a apps.tf y personaliza

# API Node.js
module "api_service" {
  source       = "../../modules/cloud-run"
  project_id   = var.project_id
  region       = var.region
  env          = var.env
  service_name = "api"
  image        = "gcr.io/${var.project_id}/api-service:latest"
  
  container_port = 3000
  cpu_limit      = "500m"
  memory_limit   = "256Mi"
  
  environment_variables = {
    NODE_ENV = "production"
    PORT     = "3000"
  }
  
  min_instances = 1
  max_instances = 20
}

# Frontend React
module "frontend" {
  source       = "../../modules/cloud-run"
  project_id   = var.project_id
  region       = var.region
  env          = var.env
  service_name = "frontend"
  image        = "gcr.io/${var.project_id}/frontend:latest"
  
  container_port = 80
  cpu_limit      = "250m"
  memory_limit   = "128Mi"
  
  environment_variables = {
    REACT_APP_API_URL = module.api_service.service_url
  }
  
  min_instances = 1
  max_instances = 10
}

# Outputs
output "api_url" {
  value = module.api_service.service_url
}

output "frontend_url" {
  value = module.frontend.service_url
} 